(function(h,wt){typeof exports=="object"&&typeof module<"u"?module.exports=wt(require("vue")):typeof define=="function"&&define.amd?define(["vue"],wt):(h=typeof globalThis<"u"?globalThis:h||self,h.GanttLib=wt(h.Vue))})(this,function(h){"use strict";function wt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Br(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ie(t){let e,n,r;t.length!==2?(e=wt,n=(u,s)=>wt(t(u),s),r=(u,s)=>t(u)-s):(e=t===wt||t===Br?t:Xr,n=t,r=t);function i(u,s,l=0,c=u.length){if(l<c){if(e(s,s)!==0)return c;do{const d=l+c>>>1;n(u[d],s)<0?l=d+1:c=d}while(l<c)}return l}function a(u,s,l=0,c=u.length){if(l<c){if(e(s,s)!==0)return c;do{const d=l+c>>>1;n(u[d],s)<=0?l=d+1:c=d}while(l<c)}return l}function o(u,s,l=0,c=u.length){const d=i(u,s,l,c-1);return d>l&&r(u[d-1],s)>-r(u[d],s)?d-1:d}return{left:i,center:o,right:a}}function Xr(){return 0}function Gr(t){return t===null?NaN:+t}const Zr=Ie(wt).right;Ie(Gr).center;class Mn extends Map{constructor(e,n=Kr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Dn(this,e))}has(e){return super.has(Dn(this,e))}set(e,n){return super.set(Qr(this,e),n)}delete(e){return super.delete(Jr(this,e))}}function Dn({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Qr({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Jr({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Kr(t){return t!==null&&typeof t=="object"?t.valueOf():t}const jr=Math.sqrt(50),ti=Math.sqrt(10),ei=Math.sqrt(2);function Cn(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=jr?10:a>=ti?5:a>=ei?2:1;let u,s,l;return i<0?(l=Math.pow(10,-i)/o,u=Math.round(t*l),s=Math.round(e*l),u/l<t&&++u,s/l>e&&--s,l=-l):(l=Math.pow(10,i)*o,u=Math.round(t/l),s=Math.round(e/l),u*l<t&&++u,s*l>e&&--s),s<u&&.5<=n&&n<2?Cn(t,e,n*2):[u,s,l]}function kn(t,e,n){return e=+e,t=+t,n=+n,Cn(t,e,n)[2]}function Nn(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?kn(e,t,n):kn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function ni(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function ri(t){return t}var Ye=1,He=2,Le=3,Jt=4,Sn=1e-6;function ii(t){return"translate("+t+",0)"}function ai(t){return"translate(0,"+t+")"}function oi(t){return e=>+t(e)}function ui(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function si(){return!this.__axis}function En(t,e){var n=[],r=null,i=null,a=6,o=6,u=3,s=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===Ye||t===Jt?-1:1,c=t===Jt||t===He?"x":"y",d=t===Ye||t===Le?ii:ai;function f(g){var C=r??(e.ticks?e.ticks.apply(e,n):e.domain()),N=i??(e.tickFormat?e.tickFormat.apply(e,n):ri),F=Math.max(a,0)+u,b=e.range(),I=+b[0]+s,$=+b[b.length-1]+s,v=(e.bandwidth?ui:oi)(e.copy(),s),k=g.selection?g.selection():g,_=k.selectAll(".domain").data([null]),T=k.selectAll(".tick").data(C,e).order(),V=T.exit(),Y=T.enter().append("g").attr("class","tick"),W=T.select("line"),H=T.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(Y),W=W.merge(Y.append("line").attr("stroke","currentColor").attr(c+"2",l*a)),H=H.merge(Y.append("text").attr("fill","currentColor").attr(c,l*F).attr("dy",t===Ye?"0em":t===Le?"0.71em":"0.32em")),g!==k&&(_=_.transition(g),T=T.transition(g),W=W.transition(g),H=H.transition(g),V=V.transition(g).attr("opacity",Sn).attr("transform",function(Z){return isFinite(Z=v(Z))?d(Z+s):this.getAttribute("transform")}),Y.attr("opacity",Sn).attr("transform",function(Z){var ot=this.parentNode.__axis;return d((ot&&isFinite(ot=ot(Z))?ot:v(Z))+s)})),V.remove(),_.attr("d",t===Jt||t===He?o?"M"+l*o+","+I+"H"+s+"V"+$+"H"+l*o:"M"+s+","+I+"V"+$:o?"M"+I+","+l*o+"V"+s+"H"+$+"V"+l*o:"M"+I+","+s+"H"+$),T.attr("opacity",1).attr("transform",function(Z){return d(v(Z)+s)}),W.attr(c+"2",l*a),H.attr(c,l*F).text(N),k.filter(si).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===He?"start":t===Jt?"end":"middle"),k.each(function(){this.__axis=v})}return f.scale=function(g){return arguments.length?(e=g,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),f):n.slice()},f.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),f):r&&r.slice()},f.tickFormat=function(g){return arguments.length?(i=g,f):i},f.tickSize=function(g){return arguments.length?(a=o=+g,f):a},f.tickSizeInner=function(g){return arguments.length?(a=+g,f):a},f.tickSizeOuter=function(g){return arguments.length?(o=+g,f):o},f.tickPadding=function(g){return arguments.length?(u=+g,f):u},f.offset=function(g){return arguments.length?(s=+g,f):s},f}function li(t){return En(Le,t)}function ci(t){return En(Jt,t)}var fi={value:()=>{}};function Re(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new he(n)}function he(t){this._=t}function hi(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}he.prototype=Re.prototype={constructor:he,on:function(t,e){var n=this._,r=hi(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=di(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=An(n[i],t.name,e);else if(e==null)for(i in n)n[i]=An(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new he(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function di(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function An(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=fi,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Oe="http://www.w3.org/1999/xhtml";const Un={svg:"http://www.w3.org/2000/svg",xhtml:Oe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Un.hasOwnProperty(e)?{space:Un[e],local:t}:t}function gi(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Oe&&e.documentElement.namespaceURI===Oe?e.createElement(t):e.createElementNS(n,t)}}function mi(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Fn(t){var e=de(t);return(e.local?mi:gi)(e)}function pi(){}function qe(t){return t==null?pi:function(){return this.querySelector(t)}}function yi(t){typeof t!="function"&&(t=qe(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=new Array(o),s,l,c=0;c<o;++c)(s=a[c])&&(l=t.call(s,s.__data__,c,a))&&("__data__"in s&&(l.__data__=s.__data__),u[c]=l);return new j(r,this._parents)}function xi(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function vi(){return[]}function $n(t){return t==null?vi:function(){return this.querySelectorAll(t)}}function wi(t){return function(){return xi(t.apply(this,arguments))}}function _i(t){typeof t=="function"?t=wi(t):t=$n(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o=e[a],u=o.length,s,l=0;l<u;++l)(s=o[l])&&(r.push(t.call(s,s.__data__,l,o)),i.push(s));return new j(r,i)}function Vn(t){return function(){return this.matches(t)}}function In(t){return function(e){return e.matches(t)}}var bi=Array.prototype.find;function Ti(t){return function(){return bi.call(this.children,t)}}function Mi(){return this.firstElementChild}function Di(t){return this.select(t==null?Mi:Ti(typeof t=="function"?t:In(t)))}var Ci=Array.prototype.filter;function ki(){return Array.from(this.children)}function Ni(t){return function(){return Ci.call(this.children,t)}}function Si(t){return this.selectAll(t==null?ki:Ni(typeof t=="function"?t:In(t)))}function Ei(t){typeof t!="function"&&(t=Vn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=[],s,l=0;l<o;++l)(s=a[l])&&t.call(s,s.__data__,l,a)&&u.push(s);return new j(r,this._parents)}function Yn(t){return new Array(t.length)}function Ai(){return new j(this._enter||this._groups.map(Yn),this._parents)}function ge(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ge.prototype={constructor:ge,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ui(t){return function(){return t}}function Fi(t,e,n,r,i,a){for(var o=0,u,s=e.length,l=a.length;o<l;++o)(u=e[o])?(u.__data__=a[o],r[o]=u):n[o]=new ge(t,a[o]);for(;o<s;++o)(u=e[o])&&(i[o]=u)}function $i(t,e,n,r,i,a,o){var u,s,l=new Map,c=e.length,d=a.length,f=new Array(c),g;for(u=0;u<c;++u)(s=e[u])&&(f[u]=g=o.call(s,s.__data__,u,e)+"",l.has(g)?i[u]=s:l.set(g,s));for(u=0;u<d;++u)g=o.call(t,a[u],u,a)+"",(s=l.get(g))?(r[u]=s,s.__data__=a[u],l.delete(g)):n[u]=new ge(t,a[u]);for(u=0;u<c;++u)(s=e[u])&&l.get(f[u])===s&&(i[u]=s)}function Vi(t){return t.__data__}function Ii(t,e){if(!arguments.length)return Array.from(this,Vi);var n=e?$i:Fi,r=this._parents,i=this._groups;typeof t!="function"&&(t=Ui(t));for(var a=i.length,o=new Array(a),u=new Array(a),s=new Array(a),l=0;l<a;++l){var c=r[l],d=i[l],f=d.length,g=Yi(t.call(c,c&&c.__data__,l,r)),C=g.length,N=u[l]=new Array(C),F=o[l]=new Array(C),b=s[l]=new Array(f);n(c,d,N,F,b,g,e);for(var I=0,$=0,v,k;I<C;++I)if(v=N[I]){for(I>=$&&($=I+1);!(k=F[$])&&++$<C;);v._next=k||null}}return o=new j(o,r),o._enter=u,o._exit=s,o}function Yi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Hi(){return new j(this._exit||this._groups.map(Yn),this._parents)}function Li(t,e,n){var r=this.enter(),i=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Ri(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),u=new Array(i),s=0;s<o;++s)for(var l=n[s],c=r[s],d=l.length,f=u[s]=new Array(d),g,C=0;C<d;++C)(g=l[C]||c[C])&&(f[C]=g);for(;s<i;++s)u[s]=n[s];return new j(u,this._parents)}function Oi(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function qi(t){t||(t=Pi);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],u=o.length,s=i[a]=new Array(u),l,c=0;c<u;++c)(l=o[c])&&(s[c]=l);s.sort(e)}return new j(i,this._parents).order()}function Pi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Wi(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function zi(){return Array.from(this)}function Bi(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Xi(){let t=0;for(const e of this)++t;return t}function Gi(){return!this.node()}function Zi(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,o=i.length,u;a<o;++a)(u=i[a])&&t.call(u,u.__data__,a,i);return this}function Qi(t){return function(){this.removeAttribute(t)}}function Ji(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ki(t,e){return function(){this.setAttribute(t,e)}}function ji(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ta(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ea(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function na(t,e){var n=de(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ji:Qi:typeof e=="function"?n.local?ea:ta:n.local?ji:Ki)(n,e))}function Hn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ra(t){return function(){this.style.removeProperty(t)}}function ia(t,e,n){return function(){this.style.setProperty(t,e,n)}}function aa(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function oa(t,e,n){return arguments.length>1?this.each((e==null?ra:typeof e=="function"?aa:ia)(t,e,n??"")):Ht(this.node(),t)}function Ht(t,e){return t.style.getPropertyValue(e)||Hn(t).getComputedStyle(t,null).getPropertyValue(e)}function ua(t){return function(){delete this[t]}}function sa(t,e){return function(){this[t]=e}}function la(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ca(t,e){return arguments.length>1?this.each((e==null?ua:typeof e=="function"?la:sa)(t,e)):this.node()[t]}function Ln(t){return t.trim().split(/^|\s+/)}function Pe(t){return t.classList||new Rn(t)}function Rn(t){this._node=t,this._names=Ln(t.getAttribute("class")||"")}Rn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function On(t,e){for(var n=Pe(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function qn(t,e){for(var n=Pe(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function fa(t){return function(){On(this,t)}}function ha(t){return function(){qn(this,t)}}function da(t,e){return function(){(e.apply(this,arguments)?On:qn)(this,t)}}function ga(t,e){var n=Ln(t+"");if(arguments.length<2){for(var r=Pe(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?da:e?fa:ha)(n,e))}function ma(){this.textContent=""}function pa(t){return function(){this.textContent=t}}function ya(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function xa(t){return arguments.length?this.each(t==null?ma:(typeof t=="function"?ya:pa)(t)):this.node().textContent}function va(){this.innerHTML=""}function wa(t){return function(){this.innerHTML=t}}function _a(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ba(t){return arguments.length?this.each(t==null?va:(typeof t=="function"?_a:wa)(t)):this.node().innerHTML}function Ta(){this.nextSibling&&this.parentNode.appendChild(this)}function Ma(){return this.each(Ta)}function Da(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ca(){return this.each(Da)}function ka(t){var e=typeof t=="function"?t:Fn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Na(){return null}function Sa(t,e){var n=typeof t=="function"?t:Fn(t),r=e==null?Na:typeof e=="function"?e:qe(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ea(){var t=this.parentNode;t&&t.removeChild(this)}function Aa(){return this.each(Ea)}function Ua(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Fa(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function $a(t){return this.select(t?Fa:Ua)}function Va(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ia(t){return function(e){t.call(this,e,this.__data__)}}function Ya(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ha(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function La(t,e,n){return function(){var r=this.__on,i,a=Ia(e);if(r){for(var o=0,u=r.length;o<u;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Ra(t,e,n){var r=Ya(t+""),i,a=r.length,o;if(arguments.length<2){var u=this.node().__on;if(u){for(var s=0,l=u.length,c;s<l;++s)for(i=0,c=u[s];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(u=e?La:Ha,i=0;i<a;++i)this.each(u(r[i],e,n));return this}function Pn(t,e,n){var r=Hn(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Oa(t,e){return function(){return Pn(this,t,e)}}function qa(t,e){return function(){return Pn(this,t,e.apply(this,arguments))}}function Pa(t,e){return this.each((typeof e=="function"?qa:Oa)(t,e))}function*Wa(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Wn=[null];function j(t,e){this._groups=t,this._parents=e}function Kt(){return new j([[document.documentElement]],Wn)}function za(){return this}j.prototype=Kt.prototype={constructor:j,select:yi,selectAll:_i,selectChild:Di,selectChildren:Si,filter:Ei,data:Ii,enter:Ai,exit:Hi,join:Li,merge:Ri,selection:za,order:Oi,sort:qi,call:Wi,nodes:zi,node:Bi,size:Xi,empty:Gi,each:Zi,attr:na,style:oa,property:ca,classed:ga,text:xa,html:ba,raise:Ma,lower:Ca,append:ka,insert:Sa,remove:Aa,clone:$a,datum:Va,on:Ra,dispatch:Pa,[Symbol.iterator]:Wa};function Q(t){return typeof t=="string"?new j([[document.querySelector(t)]],[document.documentElement]):new j([[t]],Wn)}function Ba(t){let e;for(;e=t.sourceEvent;)t=e;return t}function zn(t,e){if(t=Ba(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Xa={passive:!1},jt={capture:!0,passive:!1};function We(t){t.stopImmediatePropagation()}function Lt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ga(t){var e=t.document.documentElement,n=Q(t).on("dragstart.drag",Lt,jt);"onselectstart"in e?n.on("selectstart.drag",Lt,jt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Za(t,e){var n=t.document.documentElement,r=Q(t).on("dragstart.drag",null);e&&(r.on("click.drag",Lt,jt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const me=t=>()=>t;function ze(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:u,dx:s,dy:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}ze.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Qa(t){return!t.ctrlKey&&!t.button}function Ja(){return this.parentNode}function Ka(t,e){return e??{x:t.x,y:t.y}}function ja(){return navigator.maxTouchPoints||"ontouchstart"in this}function to(){var t=Qa,e=Ja,n=Ka,r=ja,i={},a=Re("start","drag","end"),o=0,u,s,l,c,d=0;function f(v){v.on("mousedown.drag",g).filter(r).on("touchstart.drag",F).on("touchmove.drag",b,Xa).on("touchend.drag touchcancel.drag",I).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(v,k){if(!(c||!t.call(this,v,k))){var _=$(this,e.call(this,v,k),v,k,"mouse");_&&(Q(v.view).on("mousemove.drag",C,jt).on("mouseup.drag",N,jt),Ga(v.view),We(v),l=!1,u=v.clientX,s=v.clientY,_("start",v))}}function C(v){if(Lt(v),!l){var k=v.clientX-u,_=v.clientY-s;l=k*k+_*_>d}i.mouse("drag",v)}function N(v){Q(v.view).on("mousemove.drag mouseup.drag",null),Za(v.view,l),Lt(v),i.mouse("end",v)}function F(v,k){if(t.call(this,v,k)){var _=v.changedTouches,T=e.call(this,v,k),V=_.length,Y,W;for(Y=0;Y<V;++Y)(W=$(this,T,v,k,_[Y].identifier,_[Y]))&&(We(v),W("start",v,_[Y]))}}function b(v){var k=v.changedTouches,_=k.length,T,V;for(T=0;T<_;++T)(V=i[k[T].identifier])&&(Lt(v),V("drag",v,k[T]))}function I(v){var k=v.changedTouches,_=k.length,T,V;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),T=0;T<_;++T)(V=i[k[T].identifier])&&(We(v),V("end",v,k[T]))}function $(v,k,_,T,V,Y){var W=a.copy(),H=zn(Y||_,k),Z,ot,bt;if((bt=n.call(v,new ze("beforestart",{sourceEvent:_,target:f,identifier:V,active:o,x:H[0],y:H[1],dx:0,dy:0,dispatch:W}),T))!=null)return Z=bt.x-H[0]||0,ot=bt.y-H[1]||0,function fe(Ut,z,nt){var ut=H,Tt;switch(Ut){case"start":i[V]=fe,Tt=o++;break;case"end":delete i[V],--o;case"drag":H=zn(nt||z,k),Tt=o;break}W.call(Ut,v,new ze(Ut,{sourceEvent:z,subject:bt,target:f,identifier:V,active:Tt,x:H[0]+Z,y:H[1]+ot,dx:H[0]-ut[0],dy:H[1]-ut[1],dispatch:W}),T)}}return f.filter=function(v){return arguments.length?(t=typeof v=="function"?v:me(!!v),f):t},f.container=function(v){return arguments.length?(e=typeof v=="function"?v:me(v),f):e},f.subject=function(v){return arguments.length?(n=typeof v=="function"?v:me(v),f):n},f.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:me(!!v),f):r},f.on=function(){var v=a.on.apply(a,arguments);return v===a?f:v},f.clickDistance=function(v){return arguments.length?(d=(v=+v)*v,f):Math.sqrt(d)},f}function Be(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Bn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function te(){}var ee=.7,pe=1/ee,Rt="\\s*([+-]?\\d+)\\s*",ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",st="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eo=/^#([0-9a-f]{3,8})$/,no=new RegExp(`^rgb\\(${Rt},${Rt},${Rt}\\)$`),ro=new RegExp(`^rgb\\(${st},${st},${st}\\)$`),io=new RegExp(`^rgba\\(${Rt},${Rt},${Rt},${ne}\\)$`),ao=new RegExp(`^rgba\\(${st},${st},${st},${ne}\\)$`),oo=new RegExp(`^hsl\\(${ne},${st},${st}\\)$`),uo=new RegExp(`^hsla\\(${ne},${st},${st},${ne}\\)$`),Xn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Be(te,Dt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Gn,formatHex:Gn,formatHex8:so,formatHsl:lo,formatRgb:Zn,toString:Zn});function Gn(){return this.rgb().formatHex()}function so(){return this.rgb().formatHex8()}function lo(){return tr(this).formatHsl()}function Zn(){return this.rgb().formatRgb()}function Dt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=eo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Qn(e):n===3?new J(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ye(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ye(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=no.exec(t))?new J(e[1],e[2],e[3],1):(e=ro.exec(t))?new J(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=io.exec(t))?ye(e[1],e[2],e[3],e[4]):(e=ao.exec(t))?ye(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=oo.exec(t))?jn(e[1],e[2]/100,e[3]/100,1):(e=uo.exec(t))?jn(e[1],e[2]/100,e[3]/100,e[4]):Xn.hasOwnProperty(t)?Qn(Xn[t]):t==="transparent"?new J(NaN,NaN,NaN,0):null}function Qn(t){return new J(t>>16&255,t>>8&255,t&255,1)}function ye(t,e,n,r){return r<=0&&(t=e=n=NaN),new J(t,e,n,r)}function co(t){return t instanceof te||(t=Dt(t)),t?(t=t.rgb(),new J(t.r,t.g,t.b,t.opacity)):new J}function Xe(t,e,n,r){return arguments.length===1?co(t):new J(t,e,n,r??1)}function J(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Be(J,Xe,Bn(te,{brighter(t){return t=t==null?pe:Math.pow(pe,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ee:Math.pow(ee,t),new J(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new J(Ct(this.r),Ct(this.g),Ct(this.b),xe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jn,formatHex:Jn,formatHex8:fo,formatRgb:Kn,toString:Kn}));function Jn(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}`}function fo(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}${kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Kn(){const t=xe(this.opacity);return`${t===1?"rgb(":"rgba("}${Ct(this.r)}, ${Ct(this.g)}, ${Ct(this.b)}${t===1?")":`, ${t})`}`}function xe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ct(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kt(t){return t=Ct(t),(t<16?"0":"")+t.toString(16)}function jn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new rt(t,e,n,r)}function tr(t){if(t instanceof rt)return new rt(t.h,t.s,t.l,t.opacity);if(t instanceof te||(t=Dt(t)),!t)return new rt;if(t instanceof rt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,s=(a+i)/2;return u?(e===a?o=(n-r)/u+(n<r)*6:n===a?o=(r-e)/u+2:o=(e-n)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new rt(o,u,s,t.opacity)}function ho(t,e,n,r){return arguments.length===1?tr(t):new rt(t,e,n,r??1)}function rt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Be(rt,ho,Bn(te,{brighter(t){return t=t==null?pe:Math.pow(pe,t),new rt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ee:Math.pow(ee,t),new rt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new J(Ge(t>=240?t-240:t+120,i,r),Ge(t,i,r),Ge(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new rt(er(this.h),ve(this.s),ve(this.l),xe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=xe(this.opacity);return`${t===1?"hsl(":"hsla("}${er(this.h)}, ${ve(this.s)*100}%, ${ve(this.l)*100}%${t===1?")":`, ${t})`}`}}));function er(t){return t=(t||0)%360,t<0?t+360:t}function ve(t){return Math.max(0,Math.min(1,t||0))}function Ge(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ze=t=>()=>t;function go(t,e){return function(n){return t+n*e}}function mo(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function po(t){return(t=+t)==1?nr:function(e,n){return n-e?mo(e,n,t):Ze(isNaN(e)?n:e)}}function nr(t,e){var n=e-t;return n?go(t,n):Ze(isNaN(t)?e:t)}const we=function t(e){var n=po(e);function r(i,a){var o=n((i=Xe(i)).r,(a=Xe(a)).r),u=n(i.g,a.g),s=n(i.b,a.b),l=nr(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=u(c),i.b=s(c),i.opacity=l(c),i+""}}return r.gamma=t,r}(1);function yo(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function xo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function vo(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=Ke(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<r;++o)a[o]=i[o](u);return a}}function wo(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function it(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function _o(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Ke(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var Qe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Je=new RegExp(Qe.source,"g");function bo(t){return function(){return t}}function To(t){return function(e){return t(e)+""}}function rr(t,e){var n=Qe.lastIndex=Je.lastIndex=0,r,i,a,o=-1,u=[],s=[];for(t=t+"",e=e+"";(r=Qe.exec(t))&&(i=Je.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,s.push({i:o,x:it(r,i)})),n=Je.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?To(s[0].x):bo(e):(e=s.length,function(l){for(var c=0,d;c<e;++c)u[(d=s[c]).i]=d.x(l);return u.join("")})}function Ke(t,e){var n=typeof e,r;return e==null||n==="boolean"?Ze(e):(n==="number"?it:n==="string"?(r=Dt(e))?(e=r,we):rr:e instanceof Dt?we:e instanceof Date?wo:xo(e)?yo:Array.isArray(e)?vo:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?_o:it)(t,e)}function Mo(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ir=180/Math.PI,je={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ar(t,e,n,r,i,a){var o,u,s;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*ir,skewX:Math.atan(s)*ir,scaleX:o,scaleY:u}}var _e;function Do(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?je:ar(e.a,e.b,e.c,e.d,e.e,e.f)}function Co(t){return t==null||(_e||(_e=document.createElementNS("http://www.w3.org/2000/svg","g")),_e.setAttribute("transform",t),!(t=_e.transform.baseVal.consolidate()))?je:(t=t.matrix,ar(t.a,t.b,t.c,t.d,t.e,t.f))}function or(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,d,f,g,C){if(l!==d||c!==f){var N=g.push("translate(",null,e,null,n);C.push({i:N-4,x:it(l,d)},{i:N-2,x:it(c,f)})}else(d||f)&&g.push("translate("+d+e+f+n)}function o(l,c,d,f){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:it(l,c)})):c&&d.push(i(d)+"rotate("+c+r)}function u(l,c,d,f){l!==c?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:it(l,c)}):c&&d.push(i(d)+"skewX("+c+r)}function s(l,c,d,f,g,C){if(l!==d||c!==f){var N=g.push(i(g)+"scale(",null,",",null,")");C.push({i:N-4,x:it(l,d)},{i:N-2,x:it(c,f)})}else(d!==1||f!==1)&&g.push(i(g)+"scale("+d+","+f+")")}return function(l,c){var d=[],f=[];return l=t(l),c=t(c),a(l.translateX,l.translateY,c.translateX,c.translateY,d,f),o(l.rotate,c.rotate,d,f),u(l.skewX,c.skewX,d,f),s(l.scaleX,l.scaleY,c.scaleX,c.scaleY,d,f),l=c=null,function(g){for(var C=-1,N=f.length,F;++C<N;)d[(F=f[C]).i]=F.x(g);return d.join("")}}}var ko=or(Do,"px, ","px)","deg)"),No=or(Co,", ",")",")"),Ot=0,re=0,ie=0,ur=1e3,be,ae,Te=0,Nt=0,Me=0,oe=typeof performance=="object"&&performance.now?performance:Date,sr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tn(){return Nt||(sr(So),Nt=oe.now()+Me)}function So(){Nt=0}function De(){this._call=this._time=this._next=null}De.prototype=lr.prototype={constructor:De,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?tn():+n)+(e==null?0:+e),!this._next&&ae!==this&&(ae?ae._next=this:be=this,ae=this),this._call=t,this._time=n,en()},stop:function(){this._call&&(this._call=null,this._time=1/0,en())}};function lr(t,e,n){var r=new De;return r.restart(t,e,n),r}function Eo(){tn(),++Ot;for(var t=be,e;t;)(e=Nt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ot}function cr(){Nt=(Te=oe.now())+Me,Ot=re=0;try{Eo()}finally{Ot=0,Uo(),Nt=0}}function Ao(){var t=oe.now(),e=t-Te;e>ur&&(Me-=e,Te=t)}function Uo(){for(var t,e=be,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:be=n);ae=t,en(r)}function en(t){if(!Ot){re&&(re=clearTimeout(re));var e=t-Nt;e>24?(t<1/0&&(re=setTimeout(cr,t-oe.now()-Me)),ie&&(ie=clearInterval(ie))):(ie||(Te=oe.now(),ie=setInterval(Ao,ur)),Ot=1,sr(cr))}}function fr(t,e,n){var r=new De;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Fo=Re("start","end","cancel","interrupt"),$o=[],hr=0,dr=1,nn=2,Ce=3,gr=4,rn=5,ke=6;function Ne(t,e,n,r,i,a){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Vo(t,n,{name:e,index:r,group:i,on:Fo,tween:$o,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:hr})}function an(t,e){var n=at(t,e);if(n.state>hr)throw new Error("too late; already scheduled");return n}function lt(t,e){var n=at(t,e);if(n.state>Ce)throw new Error("too late; already running");return n}function at(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Vo(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=lr(a,0,n.time);function a(l){n.state=dr,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var c,d,f,g;if(n.state!==dr)return s();for(c in r)if(g=r[c],g.name===n.name){if(g.state===Ce)return fr(o);g.state===gr?(g.state=ke,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[c]):+c<e&&(g.state=ke,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[c])}if(fr(function(){n.state===Ce&&(n.state=gr,n.timer.restart(u,n.delay,n.time),u(l))}),n.state=nn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===nn){for(n.state=Ce,i=new Array(f=n.tween.length),c=0,d=-1;c<f;++c)(g=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=g);i.length=d+1}}function u(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(s),n.state=rn,1),d=-1,f=i.length;++d<f;)i[d].call(t,c);n.state===rn&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){n.state=ke,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function Io(t,e){var n=t.__transition,r,i,a=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){a=!1;continue}i=r.state>nn&&r.state<rn,r.state=ke,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}a&&delete t.__transition}}function Yo(t){return this.each(function(){Io(this,t)})}function Ho(t,e){var n,r;return function(){var i=lt(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,u=r.length;o<u;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Lo(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=lt(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:e,value:n},s=0,l=i.length;s<l;++s)if(i[s].name===e){i[s]=u;break}s===l&&i.push(u)}a.tween=i}}function Ro(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=at(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?Ho:Lo)(n,t,e))}function on(t,e,n){var r=t._id;return t.each(function(){var i=lt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return at(i,r).value[e]}}function mr(t,e){var n;return(typeof e=="number"?it:e instanceof Dt?we:(n=Dt(e))?(e=n,we):rr)(t,e)}function Oo(t){return function(){this.removeAttribute(t)}}function qo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Po(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function Wo(t,e,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function zo(t,e,n){var r,i,a;return function(){var o,u=n(this),s;return u==null?void this.removeAttribute(t):(o=this.getAttribute(t),s=u+"",o===s?null:o===r&&s===i?a:(i=s,a=e(r=o,u)))}}function Bo(t,e,n){var r,i,a;return function(){var o,u=n(this),s;return u==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),s=u+"",o===s?null:o===r&&s===i?a:(i=s,a=e(r=o,u)))}}function Xo(t,e){var n=de(t),r=n==="transform"?No:mr;return this.attrTween(t,typeof e=="function"?(n.local?Bo:zo)(n,r,on(this,"attr."+t,e)):e==null?(n.local?qo:Oo)(n):(n.local?Wo:Po)(n,r,e))}function Go(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Zo(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Qo(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Zo(t,a)),n}return i._value=e,i}function Jo(t,e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Go(t,a)),n}return i._value=e,i}function Ko(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=de(t);return this.tween(n,(r.local?Qo:Jo)(r,e))}function jo(t,e){return function(){an(this,t).delay=+e.apply(this,arguments)}}function tu(t,e){return e=+e,function(){an(this,t).delay=e}}function eu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?jo:tu)(e,t)):at(this.node(),e).delay}function nu(t,e){return function(){lt(this,t).duration=+e.apply(this,arguments)}}function ru(t,e){return e=+e,function(){lt(this,t).duration=e}}function iu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?nu:ru)(e,t)):at(this.node(),e).duration}function au(t,e){if(typeof e!="function")throw new Error;return function(){lt(this,t).ease=e}}function ou(t){var e=this._id;return arguments.length?this.each(au(e,t)):at(this.node(),e).ease}function uu(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;lt(this,t).ease=n}}function su(t){if(typeof t!="function")throw new Error;return this.each(uu(this._id,t))}function lu(t){typeof t!="function"&&(t=Vn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a=e[i],o=a.length,u=r[i]=[],s,l=0;l<o;++l)(s=a[l])&&t.call(s,s.__data__,l,a)&&u.push(s);return new ft(r,this._parents,this._name,this._id)}function cu(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s=e[u],l=n[u],c=s.length,d=o[u]=new Array(c),f,g=0;g<c;++g)(f=s[g]||l[g])&&(d[g]=f);for(;u<r;++u)o[u]=e[u];return new ft(o,this._parents,this._name,this._id)}function fu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function hu(t,e,n){var r,i,a=fu(e)?an:lt;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(e,n),o.on=i}}function du(t,e){var n=this._id;return arguments.length<2?at(this.node(),n).on.on(t):this.each(hu(n,t,e))}function gu(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function mu(){return this.on("end.remove",gu(this._id))}function pu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=qe(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var u=r[o],s=u.length,l=a[o]=new Array(s),c,d,f=0;f<s;++f)(c=u[f])&&(d=t.call(c,c.__data__,f,u))&&("__data__"in c&&(d.__data__=c.__data__),l[f]=d,Ne(l[f],e,n,f,l,at(c,n)));return new ft(a,this._parents,e,n)}function yu(t){var e=this._name,n=this._id;typeof t!="function"&&(t=$n(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var s=r[u],l=s.length,c,d=0;d<l;++d)if(c=s[d]){for(var f=t.call(c,c.__data__,d,s),g,C=at(c,n),N=0,F=f.length;N<F;++N)(g=f[N])&&Ne(g,e,n,N,f,C);a.push(f),o.push(c)}return new ft(a,o,e,n)}var xu=Kt.prototype.constructor;function vu(){return new xu(this._groups,this._parents)}function wu(t,e){var n,r,i;return function(){var a=Ht(this,t),o=(this.style.removeProperty(t),Ht(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}function pr(t){return function(){this.style.removeProperty(t)}}function _u(t,e,n){var r,i=n+"",a;return function(){var o=Ht(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}function bu(t,e,n){var r,i,a;return function(){var o=Ht(this,t),u=n(this),s=u+"";return u==null&&(s=u=(this.style.removeProperty(t),Ht(this,t))),o===s?null:o===r&&s===i?a:(i=s,a=e(r=o,u))}}function Tu(t,e){var n,r,i,a="style."+e,o="end."+a,u;return function(){var s=lt(this,t),l=s.on,c=s.value[a]==null?u||(u=pr(e)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(o,i=c),s.on=r}}function Mu(t,e,n){var r=(t+="")=="transform"?ko:mr;return e==null?this.styleTween(t,wu(t,r)).on("end.style."+t,pr(t)):typeof e=="function"?this.styleTween(t,bu(t,r,on(this,"style."+t,e))).each(Tu(this._id,t)):this.styleTween(t,_u(t,r,e),n).on("end.style."+t,null)}function Du(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Cu(t,e,n){var r,i;function a(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Du(t,o,n)),r}return a._value=e,a}function ku(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Cu(t,e,n??""))}function Nu(t){return function(){this.textContent=t}}function Su(t){return function(){var e=t(this);this.textContent=e??""}}function Eu(t){return this.tween("text",typeof t=="function"?Su(on(this,"text",t)):Nu(t==null?"":t+""))}function Au(t){return function(e){this.textContent=t.call(this,e)}}function Uu(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Au(i)),e}return r._value=t,r}function Fu(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Uu(t))}function $u(){for(var t=this._name,e=this._id,n=yr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,s,l=0;l<u;++l)if(s=o[l]){var c=at(s,e);Ne(s,t,n,l,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ft(r,this._parents,t,n)}function Vu(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var u={value:o},s={value:function(){--i===0&&a()}};n.each(function(){var l=lt(this,r),c=l.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(s)),l.on=e}),i===0&&a()})}var Iu=0;function ft(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function yr(){return++Iu}var ht=Kt.prototype;ft.prototype={constructor:ft,select:pu,selectAll:yu,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:lu,merge:cu,selection:vu,transition:$u,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:du,attr:Xo,attrTween:Ko,style:Mu,styleTween:ku,text:Eu,textTween:Fu,remove:mu,tween:Ro,delay:eu,duration:iu,ease:ou,easeVarying:su,end:Vu,[Symbol.iterator]:ht[Symbol.iterator]};function Yu(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Hu={time:null,delay:0,duration:250,ease:Yu};function Lu(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Ru(t){var e,n;t instanceof ft?(e=t._id,t=t._name):(e=yr(),(n=Hu).time=tn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],u=o.length,s,l=0;l<u;++l)(s=o[l])&&Ne(s,t,e,l,o,n||Lu(s,e));return new ft(r,this._parents,t,e)}Kt.prototype.interrupt=Yo,Kt.prototype.transition=Ru;function un(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const xr=Symbol("implicit");function vr(){var t=new Mn,e=[],n=[],r=xr;function i(a){let o=t.get(a);if(o===void 0){if(r!==xr)return r;t.set(a,o=e.push(a)-1)}return n[o%n.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new Mn;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return vr(e,n).unknown(r)},un.apply(i,arguments),i}function wr(){var t=vr().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,a,o,u=!1,s=0,l=0,c=.5;delete t.unknown;function d(){var f=e().length,g=i<r,C=g?i:r,N=g?r:i;a=(N-C)/Math.max(1,f-s+l*2),u&&(a=Math.floor(a)),C+=(N-C-a*(f-s))*c,o=a*(1-s),u&&(C=Math.round(C),o=Math.round(o));var F=ni(f).map(function(b){return C+a*b});return n(g?F.reverse():F)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,u=!0,d()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(f){return arguments.length?(u=!!f,d()):u},t.padding=function(f){return arguments.length?(s=Math.min(1,l=+f),d()):s},t.paddingInner=function(f){return arguments.length?(s=Math.min(1,f),d()):s},t.paddingOuter=function(f){return arguments.length?(l=+f,d()):l},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),d()):c},t.copy=function(){return wr(e(),[r,i]).round(u).paddingInner(s).paddingOuter(l).align(c)},un.apply(d(),arguments)}function Ou(t){return function(){return t}}function qu(t){return+t}var _r=[0,1];function qt(t){return t}function sn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Ou(isNaN(e)?NaN:.5)}function Pu(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Wu(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=sn(i,r),a=n(o,a)):(r=sn(r,i),a=n(a,o)),function(u){return a(r(u))}}function zu(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=sn(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(u){var s=Zr(t,u,1,r)-1;return a[s](i[s](u))}}function Bu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Xu(){var t=_r,e=_r,n=Ke,r,i,a,o=qt,u,s,l;function c(){var f=Math.min(t.length,e.length);return o!==qt&&(o=Pu(t[0],t[f-1])),u=f>2?zu:Wu,s=l=null,d}function d(f){return f==null||isNaN(f=+f)?a:(s||(s=u(t.map(r),e,n)))(r(o(f)))}return d.invert=function(f){return o(i((l||(l=u(e,t.map(r),it)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,qu),c()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=Mo,c()},d.clamp=function(f){return arguments.length?(o=f?!0:qt,c()):o!==qt},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(a=f,d):a},function(f,g){return r=f,i=g,c()}}function Gu(){return Xu()(qt,qt)}function Zu(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],a=t[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),t[n]=e.floor(i),t[r]=e.ceil(a),t}const ln=new Date,cn=new Date;function L(t,e,n,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,u)=>{const s=[];if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;let l;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},i.filter=a=>L(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,u)=>{if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););}),n&&(i.count=(a,o)=>(ln.setTime(+a),cn.setTime(+o),t(ln),t(cn),Math.floor(n(ln,cn))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?o=>r(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const Se=L(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Se.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?L(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Se),Se.range;const dt=1e3,et=dt*60,gt=et*60,mt=gt*24,fn=mt*7,br=mt*30,hn=mt*365,Pt=L(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*dt)},(t,e)=>(e-t)/dt,t=>t.getUTCSeconds());Pt.range;const dn=L(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*dt)},(t,e)=>{t.setTime(+t+e*et)},(t,e)=>(e-t)/et,t=>t.getMinutes());dn.range,L(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*et)},(t,e)=>(e-t)/et,t=>t.getUTCMinutes()).range;const gn=L(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*dt-t.getMinutes()*et)},(t,e)=>{t.setTime(+t+e*gt)},(t,e)=>(e-t)/gt,t=>t.getHours());gn.range,L(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*gt)},(t,e)=>(e-t)/gt,t=>t.getUTCHours()).range;const Wt=L(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*et)/mt,t=>t.getDate()-1);Wt.range;const mn=L(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/mt,t=>t.getUTCDate()-1);mn.range,L(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/mt,t=>Math.floor(t/mt)).range;function St(t){return L(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*et)/fn)}const Ee=St(0),Ae=St(1),Qu=St(2),Ju=St(3),zt=St(4),Ku=St(5),ju=St(6);Ee.range,Ae.range,Qu.range,Ju.range,zt.range,Ku.range,ju.range;function Et(t){return L(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/fn)}const Tr=Et(0),Ue=Et(1),ts=Et(2),es=Et(3),Bt=Et(4),ns=Et(5),rs=Et(6);Tr.range,Ue.range,ts.range,es.range,Bt.range,ns.range,rs.range;const pn=L(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());pn.range,L(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth()).range;const pt=L(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());pt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:L(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)}),pt.range;const At=L(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());At.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:L(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}),At.range;function is(t,e,n,r,i,a){const o=[[Pt,1,dt],[Pt,5,5*dt],[Pt,15,15*dt],[Pt,30,30*dt],[a,1,et],[a,5,5*et],[a,15,15*et],[a,30,30*et],[i,1,gt],[i,3,3*gt],[i,6,6*gt],[i,12,12*gt],[r,1,mt],[r,2,2*mt],[n,1,fn],[e,1,br],[e,3,3*br],[t,1,hn]];function u(l,c,d){const f=c<l;f&&([l,c]=[c,l]);const g=d&&typeof d.range=="function"?d:s(l,c,d),C=g?g.range(l,+c+1):[];return f?C.reverse():C}function s(l,c,d){const f=Math.abs(c-l)/d,g=Ie(([,,F])=>F).right(o,f);if(g===o.length)return t.every(Nn(l/hn,c/hn,d));if(g===0)return Se.every(Math.max(Nn(l,c,d),1));const[C,N]=o[f/o[g-1][2]<o[g][2]/f?g-1:g];return C.every(N)}return[u,s]}const[as,os]=is(pt,pn,Ee,Wt,gn,dn);function yn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function xn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ue(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function us(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,l=se(i),c=le(i),d=se(a),f=le(a),g=se(o),C=le(o),N=se(u),F=le(u),b=se(s),I=le(s),$={a:z,A:nt,b:ut,B:Tt,c:null,d:Sr,e:Sr,f:Es,g:Rs,G:qs,H:ks,I:Ns,j:Ss,L:Er,m:As,M:Us,p:vn,q:wn,Q:Ir,s:Yr,S:Fs,u:$s,U:Vs,V:Is,w:Ys,W:Hs,x:null,X:null,y:Ls,Y:Os,Z:Ps,"%":Vr},v={a:_n,A:yt,b:x,B:m,c:null,d:Ur,e:Ur,f:Xs,g:rl,G:al,H:Ws,I:zs,j:Bs,L:Fr,m:Gs,M:Zs,p:w,q:S,Q:Ir,s:Yr,S:Qs,u:Js,U:Ks,V:js,w:tl,W:el,x:null,X:null,y:nl,Y:il,Z:ol,"%":Vr},k={a:W,A:H,b:Z,B:ot,c:bt,d:kr,e:kr,f:Ts,g:Cr,G:Dr,H:Nr,I:Nr,j:vs,L:bs,m:xs,M:ws,p:Y,q:ys,Q:Ds,s:Cs,S:_s,u:hs,U:ds,V:gs,w:fs,W:ms,x:fe,X:Ut,y:Cr,Y:Dr,Z:ps,"%":Ms};$.x=_(n,$),$.X=_(r,$),$.c=_(e,$),v.x=_(n,v),v.X=_(r,v),v.c=_(e,v);function _(y,M){return function(D){var p=[],R=-1,E=0,O=y.length,q,K,Gt;for(D instanceof Date||(D=new Date(+D));++R<O;)y.charCodeAt(R)===37&&(p.push(y.slice(E,R)),(K=Mr[q=y.charAt(++R)])!=null?q=y.charAt(++R):K=q==="e"?" ":"0",(Gt=M[q])&&(q=Gt(D,K)),p.push(q),E=R+1);return p.push(y.slice(E,R)),p.join("")}}function T(y,M){return function(D){var p=ue(1900,void 0,1),R=V(p,y,D+="",0),E,O;if(R!=D.length)return null;if("Q"in p)return new Date(p.Q);if("s"in p)return new Date(p.s*1e3+("L"in p?p.L:0));if(M&&!("Z"in p)&&(p.Z=0),"p"in p&&(p.H=p.H%12+p.p*12),p.m===void 0&&(p.m="q"in p?p.q:0),"V"in p){if(p.V<1||p.V>53)return null;"w"in p||(p.w=1),"Z"in p?(E=xn(ue(p.y,0,1)),O=E.getUTCDay(),E=O>4||O===0?Ue.ceil(E):Ue(E),E=mn.offset(E,(p.V-1)*7),p.y=E.getUTCFullYear(),p.m=E.getUTCMonth(),p.d=E.getUTCDate()+(p.w+6)%7):(E=yn(ue(p.y,0,1)),O=E.getDay(),E=O>4||O===0?Ae.ceil(E):Ae(E),E=Wt.offset(E,(p.V-1)*7),p.y=E.getFullYear(),p.m=E.getMonth(),p.d=E.getDate()+(p.w+6)%7)}else("W"in p||"U"in p)&&("w"in p||(p.w="u"in p?p.u%7:"W"in p?1:0),O="Z"in p?xn(ue(p.y,0,1)).getUTCDay():yn(ue(p.y,0,1)).getDay(),p.m=0,p.d="W"in p?(p.w+6)%7+p.W*7-(O+5)%7:p.w+p.U*7-(O+6)%7);return"Z"in p?(p.H+=p.Z/100|0,p.M+=p.Z%100,xn(p)):yn(p)}}function V(y,M,D,p){for(var R=0,E=M.length,O=D.length,q,K;R<E;){if(p>=O)return-1;if(q=M.charCodeAt(R++),q===37){if(q=M.charAt(R++),K=k[q in Mr?M.charAt(R++):q],!K||(p=K(y,D,p))<0)return-1}else if(q!=D.charCodeAt(p++))return-1}return p}function Y(y,M,D){var p=l.exec(M.slice(D));return p?(y.p=c.get(p[0].toLowerCase()),D+p[0].length):-1}function W(y,M,D){var p=g.exec(M.slice(D));return p?(y.w=C.get(p[0].toLowerCase()),D+p[0].length):-1}function H(y,M,D){var p=d.exec(M.slice(D));return p?(y.w=f.get(p[0].toLowerCase()),D+p[0].length):-1}function Z(y,M,D){var p=b.exec(M.slice(D));return p?(y.m=I.get(p[0].toLowerCase()),D+p[0].length):-1}function ot(y,M,D){var p=N.exec(M.slice(D));return p?(y.m=F.get(p[0].toLowerCase()),D+p[0].length):-1}function bt(y,M,D){return V(y,e,M,D)}function fe(y,M,D){return V(y,n,M,D)}function Ut(y,M,D){return V(y,r,M,D)}function z(y){return o[y.getDay()]}function nt(y){return a[y.getDay()]}function ut(y){return s[y.getMonth()]}function Tt(y){return u[y.getMonth()]}function vn(y){return i[+(y.getHours()>=12)]}function wn(y){return 1+~~(y.getMonth()/3)}function _n(y){return o[y.getUTCDay()]}function yt(y){return a[y.getUTCDay()]}function x(y){return s[y.getUTCMonth()]}function m(y){return u[y.getUTCMonth()]}function w(y){return i[+(y.getUTCHours()>=12)]}function S(y){return 1+~~(y.getUTCMonth()/3)}return{format:function(y){var M=_(y+="",$);return M.toString=function(){return y},M},parse:function(y){var M=T(y+="",!1);return M.toString=function(){return y},M},utcFormat:function(y){var M=_(y+="",v);return M.toString=function(){return y},M},utcParse:function(y){var M=T(y+="",!0);return M.toString=function(){return y},M}}}var Mr={"-":"",_:" ",0:"0"},P=/^\s*\d+/,ss=/^%/,ls=/[\\^$*+?|[\]().{}]/g;function A(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function cs(t){return t.replace(ls,"\\$&")}function se(t){return new RegExp("^(?:"+t.map(cs).join("|")+")","i")}function le(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function fs(t,e,n){var r=P.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function hs(t,e,n){var r=P.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function ds(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function gs(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ms(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Dr(t,e,n){var r=P.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Cr(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ps(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ys(t,e,n){var r=P.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function xs(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function kr(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function vs(t,e,n){var r=P.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Nr(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ws(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function _s(t,e,n){var r=P.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function bs(t,e,n){var r=P.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Ts(t,e,n){var r=P.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ms(t,e,n){var r=ss.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Ds(t,e,n){var r=P.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Cs(t,e,n){var r=P.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Sr(t,e){return A(t.getDate(),e,2)}function ks(t,e){return A(t.getHours(),e,2)}function Ns(t,e){return A(t.getHours()%12||12,e,2)}function Ss(t,e){return A(1+Wt.count(pt(t),t),e,3)}function Er(t,e){return A(t.getMilliseconds(),e,3)}function Es(t,e){return Er(t,e)+"000"}function As(t,e){return A(t.getMonth()+1,e,2)}function Us(t,e){return A(t.getMinutes(),e,2)}function Fs(t,e){return A(t.getSeconds(),e,2)}function $s(t){var e=t.getDay();return e===0?7:e}function Vs(t,e){return A(Ee.count(pt(t)-1,t),e,2)}function Ar(t){var e=t.getDay();return e>=4||e===0?zt(t):zt.ceil(t)}function Is(t,e){return t=Ar(t),A(zt.count(pt(t),t)+(pt(t).getDay()===4),e,2)}function Ys(t){return t.getDay()}function Hs(t,e){return A(Ae.count(pt(t)-1,t),e,2)}function Ls(t,e){return A(t.getFullYear()%100,e,2)}function Rs(t,e){return t=Ar(t),A(t.getFullYear()%100,e,2)}function Os(t,e){return A(t.getFullYear()%1e4,e,4)}function qs(t,e){var n=t.getDay();return t=n>=4||n===0?zt(t):zt.ceil(t),A(t.getFullYear()%1e4,e,4)}function Ps(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+A(e/60|0,"0",2)+A(e%60,"0",2)}function Ur(t,e){return A(t.getUTCDate(),e,2)}function Ws(t,e){return A(t.getUTCHours(),e,2)}function zs(t,e){return A(t.getUTCHours()%12||12,e,2)}function Bs(t,e){return A(1+mn.count(At(t),t),e,3)}function Fr(t,e){return A(t.getUTCMilliseconds(),e,3)}function Xs(t,e){return Fr(t,e)+"000"}function Gs(t,e){return A(t.getUTCMonth()+1,e,2)}function Zs(t,e){return A(t.getUTCMinutes(),e,2)}function Qs(t,e){return A(t.getUTCSeconds(),e,2)}function Js(t){var e=t.getUTCDay();return e===0?7:e}function Ks(t,e){return A(Tr.count(At(t)-1,t),e,2)}function $r(t){var e=t.getUTCDay();return e>=4||e===0?Bt(t):Bt.ceil(t)}function js(t,e){return t=$r(t),A(Bt.count(At(t),t)+(At(t).getUTCDay()===4),e,2)}function tl(t){return t.getUTCDay()}function el(t,e){return A(Ue.count(At(t)-1,t),e,2)}function nl(t,e){return A(t.getUTCFullYear()%100,e,2)}function rl(t,e){return t=$r(t),A(t.getUTCFullYear()%100,e,2)}function il(t,e){return A(t.getUTCFullYear()%1e4,e,4)}function al(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Bt(t):Bt.ceil(t),A(t.getUTCFullYear()%1e4,e,4)}function ol(){return"+0000"}function Vr(){return"%"}function Ir(t){return+t}function Yr(t){return Math.floor(+t/1e3)}var Xt,_t;ul({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ul(t){return Xt=us(t),_t=Xt.format,Xt.parse,Xt.utcFormat,Xt.utcParse,Xt}function sl(t){return new Date(t)}function ll(t){return t instanceof Date?+t:+new Date(+t)}function Hr(t,e,n,r,i,a,o,u,s,l){var c=Gu(),d=c.invert,f=c.domain,g=l(".%L"),C=l(":%S"),N=l("%I:%M"),F=l("%I %p"),b=l("%a %d"),I=l("%b %d"),$=l("%B"),v=l("%Y");function k(_){return(s(_)<_?g:u(_)<_?C:o(_)<_?N:a(_)<_?F:r(_)<_?i(_)<_?b:I:n(_)<_?$:v)(_)}return c.invert=function(_){return new Date(d(_))},c.domain=function(_){return arguments.length?f(Array.from(_,ll)):f().map(sl)},c.ticks=function(_){var T=f();return t(T[0],T[T.length-1],_??10)},c.tickFormat=function(_,T){return T==null?k:l(T)},c.nice=function(_){var T=f();return(!_||typeof _.range!="function")&&(_=e(T[0],T[T.length-1],_??10)),_?f(Zu(T,_)):c},c.copy=function(){return Bu(c,Hr(t,e,n,r,i,a,o,u,s,l))},c}function cl(){return un.apply(Hr(as,os,pt,pn,Ee,Wt,gn,dn,Pt,_t).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ce(t,e,n){this.k=t,this.x=e,this.y=n}ce.prototype={constructor:ce,scale:function(t){return t===1?this:new ce(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ce(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},ce.prototype;const fl=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n},hl={class:"gantt-wrapper relative w-full"},dl={class:"absolute top-0 right-0 z-10 flex space-x-4 items-center mr-2"},gl={class:"flex items-center space-x-2"},ml=["value"],pl=["disabled"],yl={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-50/50 z-20"},xl={class:"text-xl font-semibold text-gray-600 p-4 bg-white rounded-lg shadow-lg"},vl={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-50/50 z-20"},wl={class:"text-xs text-gray-500 mt-2"},_l={class:"text-xs font-medium text-gray-600"},bl={class:"text-xs font-medium text-gray-600"},Tl={class:"flex justify-between items-center mb-1"},Ml=["value"],Dl={class:"space-y-1"},Cl={class:"flex items-center justify-between text-xs font-medium text-gray-600"},kl={for:"enable-freq",class:"flex items-center space-x-2 cursor-pointer"},Nl={key:0,class:"text-xs font-medium text-gray-600"},Sl={class:"text-xs font-medium text-gray-600"},El={class:"text-xs font-medium text-gray-600"},Al={class:"text-xs font-medium text-gray-600"},Ul={class:"mt-3 flex justify-between items-center"},Fl={class:"text-xs font-bold text-blue-600"},$l=5,Vl=.2,Il=fl({__name:"GanttChart",props:{tasks:{type:Array,default:()=>[]},startDate:{type:String,default:"2012-12-12"},endDate:{type:String,default:"2013-12-13"},availableCategoriesList:{type:Array,default:()=>[]}},emits:["taskUpdated"],setup(t,{emit:e}){const n=e,r=t,i=h.ref([]),a=h.ref("All"),o=["#4F46E5","#10B981","#F59E0B","#EF4444","#6366F1","#EC4899","#06B6D4"],u=h.ref({}),s=x=>{if(x.length===0)return 1;const m=[...x].sort((S,y)=>S-y),w=Math.floor(m.length/2);return m.length%2===0?(m[w-1]+m[w])/2:m[w]},l=x=>{const m=new Set;x.forEach(y=>{y.category&&y.category.trim()&&m.add(y.category)}),r.availableCategoriesList.forEach(y=>{y&&y.trim()&&m.add(y)});let w={...u.value},S=0;m.forEach(y=>{if(!w[y]){let M=o[S%o.length];w[y]=M}S++}),u.value=w},c=x=>!x||x==="Uncategorized"?"#9CA3AF":u.value[x]||"#9CA3AF",d=h.computed(()=>{const x=r.availableCategoriesList.filter(m=>m&&m.trim()).sort();return x.length===0?["Uncategorized"]:x}),f=h.computed(()=>{const x=new Set(["All"]);return r.availableCategoriesList.forEach(m=>{m&&m.trim()&&x.add(m)}),Array.from(x).sort()}),g=h.ref(null),C=h.ref(0),N={top:40,right:20,bottom:30,left:50},F=h.ref(!1),b=h.ref(null),I=(x,m)=>{if(!x||!m)return 1;const w=new Date(x),y=new Date(m).getTime()-w.getTime();if(y<0)return 1;const M=Math.ceil(y/(1e3*60*60*24))+1;return Math.max(1,M)},$=x=>I(x.start,x.end),v=h.computed(()=>{if(i.value.length===0)return 1;const x=i.value.filter(m=>m.start&&m.end).map($);return Math.max(1,s(x))}),k=(x,m)=>{if(!x||m<=0)return x;const w=new Date(x);return w.setDate(w.getDate()+m-1),_t("%Y-%m-%d")(w)},_=x=>x.toISOString().split("T")[0],T=h.computed(()=>a.value==="All"?i.value:i.value.filter(x=>x.category===a.value)),V=h.computed(()=>Math.max(150,T.value.length*40+N.top+N.bottom)),Y=h.computed(()=>{if(i.value.length===0)return new Date(r.startDate);const x=i.value.map(m=>new Date(m.start));return new Date(Math.min(...x))}),W=h.computed(()=>{if(i.value.length===0)return new Date(r.endDate);const x=i.value.map(w=>new Date(w.end)),m=new Date(Math.max(...x));return m.setDate(m.getDate()+10),m}),H=()=>{const m=(i.value.length>0?Math.max(...i.value.map(y=>y.id)):0)+1;let w,S="Planning";if(a.value!=="All"?S=a.value:i.value.length>0&&(S=i.value[i.value.length-1].category||"Planning"),i.value.length>0){const y=i.value[i.value.length-1],M=new Date(y.end).getTime()-new Date(y.start).getTime(),D=new Date(y.end);D.setDate(D.getDate()+1);const p=new Date(D.getTime()+M);w={id:m,name:`Tche Copie ${m}`,start:_(D),end:_(p),category:S,isNew:!0}}else{const y=new Date,M=new Date;M.setDate(M.getDate()+10),w={id:m,name:`Premire Tche ${m}`,start:_(y),end:_(M),category:S,isNew:!0}}i.value.push(w),l(i.value),n("taskUpdated",i.value)},Z=()=>{if(i.value.length===0)return;let x=i.value,m=-1;if(a.value!=="All"&&(x=i.value.filter(w=>w.category===a.value)),x.length>0)m=Math.max(...x.map(w=>w.id));else return;if(m!==-1){const w=i.value.filter(S=>S.id!==m);i.value=w,n("taskUpdated",i.value)}},ot=()=>{const x=[...i.value].sort((m,w)=>{const S=new Date(m.start),y=new Date(w.start);return S<y?-1:S>y?1:m.id-w.id});i.value=x,n("taskUpdated",i.value)},bt=x=>{const m=i.value.findIndex(w=>w.id===x.id);if(m!==-1){const w={...i.value[m],start:x.newStart,end:x.newEnd,category:i.value[m].category,name:x.name||i.value[m].name},S=[...i.value];S[m]=w,i.value=S,n("taskUpdated",i.value)}},fe=h.computed(()=>b.value?I(b.value.start,b.value.end):0),Ut=h.computed(()=>!b.value||!b.value.y||!g.value?{}:{position:"absolute",left:`${g.value.clientWidth/2}px`,top:`${b.value.y+N.top+5}px`,transform:"translateX(-50%)",zIndex:30,minWidth:"320px"}),z=h.ref(null),nt=h.ref(null),ut=h.ref(!1),Tt=x=>{if(F.value=!1,b.value&&b.value.id===x.id){b.value=null,ut.value=!1;return}if(!z.value||!nt.value)return;const m=0,w=0;b.value={id:x.id,name:x.name,start:x.start,end:x.end,durationDays:I(x.start,x.end),x:m,y:w,category:x.category||"Uncategorized",newCategory:null,freq:x.freq||null},ut.value=!!x.freq,h.nextTick(()=>{const S=document.querySelector(".gantt-edit-form input");S&&S.focus()})};h.watch(()=>{var x;return(x=b.value)==null?void 0:x.durationDays},(x,m)=>{if(b.value&&x){x!==m&&(b.value.end=k(b.value.start,x));const w=Math.max(1,x);b.value.durationDays=w,b.value.end=k(b.value.start,w)}}),h.watch(()=>{var x;return(x=b.value)==null?void 0:x.start},(x,m)=>{b.value&&x&&(b.value.end=k(x,Math.max(1,b.value.durationDays)),x!==m&&(b.value.durationDays=I(x,b.value.end)))});const vn=()=>{const{id:x,name:m,start:w,end:S,freq:y}=b.value,M=i.value.findIndex(Gt=>Gt.id===x);if(M===-1)return;const D=i.value[M];let{category:p}=b.value;const R=b.value.freq>0?b.value.freq:null,E=new Date(w),O=new Date(S);if(E.getTime()>=O.getTime()){console.error("La tche doit avoir une dure d'au moins un jour (date de dbut < date de fin)."),console.warn("Erreur: La date de dbut doit tre strictement antrieure  la date de fin pour garantir une dure positive. Opration annule.");return}const q={...D,name:m,start:w,end:S,category:p,freq:R},K=[...i.value];K[M]=q,i.value=K,n("taskUpdated",i.value),b.value=null,ut.value=!1},wn=h.computed(()=>b.value?c(b.value.category):"#9CA3AF"),_n=x=>{const m=Y.value,w=W.value;z.value=cl().domain([m,w]).range([0,x-N.left-N.right]),nt.value=wr().domain(Array.isArray(T.value)?T.value.map(S=>S.name):[]).range([0,T.value.length*40]).paddingInner(.1)},yt=()=>{if(!g.value)return;C.value=g.value.clientWidth;const x=C.value;_n(x);const m=Q(g.value);m.selectAll("*").remove();const S=m.append("svg").attr("width",x).attr("height",V.value).append("g").attr("transform",`translate(${N.left}, ${N.top})`);if(S.append("g").attr("transform",`translate(0, ${T.value.length*40||50})`).call(li(z.value)),S.append("g").attr("class","y-axis-g").call(ci(nt.value)).selectAll(".tick text").style("cursor","pointer").on("contextmenu",function(U,B){U.preventDefault(),U.stopPropagation();const X=B,G=T.value.find(ct=>ct.name===X);G&&Tt(G)}),!T.value.length)return;const D=v.value*$l,p=Wt.offset(Y.value,1),R=z.value(p)-z.value(Y.value);let E=!1,O,q,K=-1;const Gt=nt.value.step(),Fe=a.value!=="All",Yl=to().on("start",function(U,B){if(b.value){Q(this).style("cursor","pointer"),U.sourceEvent.stopPropagation();return}F.value=!1,E=!1,O=U.x,q=U.y,K=T.value.findIndex(X=>X.id===B.id),Q(this).raise().classed("dragging",!0).style("cursor","grabbing")}).on("drag",function(U,B){if(b.value)return;const X=U.x-O,G=U.y-q;if(Math.abs(G)>5&&!Fe)E=!0,Q(this).attr("transform",`translate(0, ${G})`);else if(Math.abs(X)>5||Fe){F.value=!0,E=!1;const ct=z.value(new Date(B.start))+X;Q(this).select("rect").attr("x",ct),Q(this).select("text").attr("x",ct+5),Q(this).attr("transform",null)}}).on("end",function(U,B){if(Q(this).style("cursor","grab"),b.value){Q(this).classed("dragging",!1).attr("transform",null);return}if(Q(this).classed("dragging",!1).attr("transform",null),E&&!Fe){const X=nt.value(B.name)+(U.y-q),G=Math.round(X/Gt),ct=Math.max(0,Math.min(T.value.length-1,G));if(ct!==K){const Ft=T.value[K].id,$t=i.value.findIndex(It=>It.id===Ft),Mt=T.value[ct].id,Vt=i.value.findIndex(It=>It.id===Mt),xt=[...i.value],[Zt]=xt.splice($t,1);xt.splice(Vt,0,Zt),i.value=xt,n("taskUpdated",i.value)}else yt()}else if(F.value){const X=z.value(new Date(B.start))+(U.x-O),G=z.value.invert(X),ct=new Date(B.end).getTime()-new Date(B.start).getTime(),Ft=new Date(G.getTime()+ct),$t=_t("%Y-%m-%d")(G),Mt=_t("%Y-%m-%d")(Ft);bt({id:B.id,name:B.name,newStart:$t,newEnd:Mt})}else yt();F.value=!1,E=!1});T.value.forEach(U=>{const B=z.value(new Date(U.start)),X=nt.value(U.name),G=nt.value.bandwidth();if(U.freq&&U.freq>0){const tt=U.freq,Yt=new Date(U.start),Qt=new Date(U.end);let vt=[],$e=new Date(Yt);for(;$e.getTime()<=Qt.getTime();)vt.push(new Date($e)),$e.setDate($e.getDate()+tt);if(vt.length===0)return;const bn=S.append("g").datum(U).attr("class","task-group task-freq"),Rr=c(U.category),Or=z.value(vt[0]),Ll=z.value(vt[vt.length-1]),qr=X+G/10;bn.append("line").attr("x1",Or).attr("y1",qr).attr("x2",Ll).attr("y2",qr).attr("stroke",Rr).attr("stroke-width",2).attr("stroke-dasharray","5, 5").attr("opacity",.6);const Ve=G/5,Tn=Ve/2;vt.forEach(Pr=>{_t("%Y-%m-%d")(Pr);const Wr=z.value(Pr)-Tn,zr=X;bn.append("rect").attr("x",Wr).attr("y",zr).attr("width",Ve).attr("height",Ve).attr("transform",`rotate(45, ${Wr+Tn}, ${zr+Tn})`).attr("rx",2).attr("fill",Rr).attr("stroke","black").attr("stroke-width",1)}),bn.append("text").text(`: ${U.name}`).attr("x",Or+Ve+5).attr("y",X+G/2+5).attr("fill","black").style("pointer-events","none").style("font-size","12px").style("font-weight","bold");return}const Ft=$(U);let $t,Mt=!1;const Vt=Ft<=2;if(!Vt&&Ft>D){Mt=!0;const tt=D*R,Qt=(Ft-D)*Vl*R;$t=tt+Qt}else Vt||($t=z.value(new Date(U.end))-B);const xt=S.append("g").datum(U).attr("class","task-group").on("contextmenu",function(tt){tt.preventDefault(),tt.sourceEvent?tt.sourceEvent.stopPropagation():tt.stopPropagation(),Tt(U)});let Zt,It;if(Vt){const tt=G/5,Yt=tt/2,Qt=B-Yt,vt=X;Zt=xt.append("rect").attr("x",Qt).attr("y",vt).attr("width",tt).attr("height",tt).attr("transform",`rotate(45, ${Qt+Yt}, ${vt+Yt})`).attr("rx",2),It=B+Yt+5}else Zt=xt.append("rect").attr("x",B).attr("y",X).attr("width",$t).attr("height",G).attr("rx",4),It=B+5;Zt.attr("fill",c(U.category)).style("cursor","grab"),Mt&&Zt.attr("stroke","black").attr("stroke-width",2),Yl(xt);const Lr=Mt?`: ${U.name}`:U.name,Hl=Vt?`: ${Lr}`:Lr;xt.append("text").text(Hl).attr("x",It).attr("y",X+G/2+5).attr("fill","black").style("pointer-events","none").style("font-size","12px").style("font-weight",Mt||Vt?"bold":"normal"),Fe&&xt.append("text").text("").attr("x",-45).attr("y",X+nt.value.bandwidth()/2+5).attr("fill","gray").style("font-size","14px").style("cursor","help").attr("title","Rorganisation dsactive en mode filtr")})};return h.watch(()=>r.tasks,x=>{Array.isArray(x)?(i.value=x.map(m=>{const{color:w,...S}=m;return{...S}}),l(i.value),yt()):(i.value=[],u.value={},yt())},{immediate:!0,deep:!0}),h.onMounted(()=>{yt(),window.addEventListener("resize",yt)}),h.watch([()=>i.value,Y,W,a],yt,{deep:!0}),(x,m)=>(h.openBlock(),h.createElementBlock("div",hl,[h.createElementVNode("div",dl,[h.createElementVNode("div",gl,[m[9]||(m[9]=h.createElementVNode("label",{for:"categoryFilter",class:"text-sm font-medium text-gray-700"},"Filtrer par:",-1)),h.withDirectives(h.createElementVNode("select",{id:"categoryFilter","onUpdate:modelValue":m[0]||(m[0]=w=>a.value=w),class:"p-1 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm"},[(h.openBlock(!0),h.createElementBlock(h.Fragment,null,h.renderList(f.value,w=>(h.openBlock(),h.createElementBlock("option",{key:w,value:w,style:h.normalizeStyle({color:w==="All"?"inherit":c(w),fontWeight:"bold"})},h.toDisplayString(w),13,ml))),128))],512),[[h.vModelSelect,a.value]])]),h.createElementVNode("button",{onClick:H,class:"bg-green-500 hover:bg-green-600 text-gray-500 font-bold py-1 px-2 rounded-full shadow-lg transition duration-150 text-lg leading-none w-8 h-8 flex items-center justify-center",title:"Ajouter une nouvelle tche (copie de la dernire)"}," + "),h.createElementVNode("button",{onClick:ot,class:"bg-blue-500 hover:bg-blue-600 text-gray-500 font-bold py-1 px-2 rounded-full shadow-lg transition duration-150 text-sm leading-none w-8 h-8 flex items-center justify-center",title:"Trier par date de dbut"},"  "),h.createElementVNode("button",{onClick:Z,disabled:i.value.length===0,class:"bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-gray-500 font-bold py-1 px-2 rounded-full shadow-lg transition duration-150 text-lg leading-none w-8 h-8 flex items-center justify-center",title:"Supprimer la dernire tche (ID max)"},"  ",8,pl)]),h.createElementVNode("div",{ref_key:"ganttContainer",ref:g,class:"relative w-full overflow-x-auto"},[T.value.length===0&&i.value.length>0?(h.openBlock(),h.createElementBlock("div",yl,[h.createElementVNode("p",xl," Aucune tche ne correspond au filtre '"+h.toDisplayString(a.value)+"'. ",1)])):i.value.length===0?(h.openBlock(),h.createElementBlock("div",vl,[...m[10]||(m[10]=[h.createElementVNode("p",{class:"text-xl font-semibold text-gray-600 p-4 bg-white rounded-lg shadow-lg"}," Le tableau de tches est vide. Utilisez '+' pour commencer ! ",-1)])])):h.createCommentVNode("",!0)],512),h.createElementVNode("div",null,[h.createElementVNode("p",wl," Time period: "+h.toDisplayString(_t("%Y-%m-%d")(Y.value))+" to "+h.toDisplayString(_t("%Y-%m-%d")(W.value)),1)]),b.value?(h.openBlock(),h.createElementBlock("div",{key:0,style:h.normalizeStyle(Ut.value),class:"gantt-edit-form p-4 border border-blue-400 rounded-lg shadow-xl flex flex-col space-y-2 z-50"},[m[18]||(m[18]=h.createElementVNode("div",{class:"form-title text-sm font-bold text-gray-800 mb-2"},"Edit",-1)),h.createElementVNode("label",_l,[m[11]||(m[11]=h.createTextVNode(" Name: ",-1)),h.withDirectives(h.createElementVNode("input",{type:"text","onUpdate:modelValue":m[1]||(m[1]=w=>b.value.name=w),class:"mt-1 p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[h.vModelText,b.value.name]])]),h.createElementVNode("label",bl,[h.createElementVNode("div",Tl,[m[12]||(m[12]=h.createElementVNode("span",null,"Category:",-1)),h.createElementVNode("span",{style:h.normalizeStyle({backgroundColor:wn.value}),class:"w-6 h-6 rounded-full border border-gray-400 inline-block"},null,4),h.withDirectives(h.createElementVNode("select",{"onUpdate:modelValue":m[2]||(m[2]=w=>b.value.category=w),class:"p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500 flex-grow"},[(h.openBlock(!0),h.createElementBlock(h.Fragment,null,h.renderList(d.value,w=>(h.openBlock(),h.createElementBlock("option",{key:w,value:w},h.toDisplayString(w),9,Ml))),128))],512),[[h.vModelSelect,b.value.category]])])]),h.createElementVNode("div",Dl,[h.createElementVNode("div",Cl,[h.createElementVNode("label",kl,[h.withDirectives(h.createElementVNode("input",{type:"checkbox",id:"enable-freq","onUpdate:modelValue":m[3]||(m[3]=w=>ut.value=w),class:"rounded text-blue-600 focus:ring-blue-500 h-4 w-4"},null,512),[[h.vModelCheckbox,ut.value]]),m[13]||(m[13]=h.createElementVNode("span",null,"Make recursive event",-1))])]),ut.value?(h.openBlock(),h.createElementBlock("label",Nl,[m[14]||(m[14]=h.createTextVNode(" Frequency (recurring in days): ",-1)),h.withDirectives(h.createElementVNode("input",{type:"number","onUpdate:modelValue":m[4]||(m[4]=w=>b.value.freq=w),placeholder:"ex: 7 pour hebdomadaire",min:"1",class:"mt-1 p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[h.vModelText,b.value.freq,void 0,{number:!0}]])])):h.createCommentVNode("",!0)]),m[19]||(m[19]=h.createElementVNode("hr",{class:"border-gray-200 my-1"},null,-1)),h.createElementVNode("label",Sl,[m[15]||(m[15]=h.createTextVNode(" Duration (in days): ",-1)),h.withDirectives(h.createElementVNode("input",{type:"number","onUpdate:modelValue":m[5]||(m[5]=w=>b.value.durationDays=w),min:"1",class:"mt-1 p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[h.vModelText,b.value.durationDays,void 0,{number:!0}]])]),h.createElementVNode("label",El,[m[16]||(m[16]=h.createTextVNode(" Start: ",-1)),h.withDirectives(h.createElementVNode("input",{type:"date","onUpdate:modelValue":m[6]||(m[6]=w=>b.value.start=w),class:"mt-1 p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[h.vModelText,b.value.start]])]),h.createElementVNode("label",Al,[m[17]||(m[17]=h.createTextVNode(" End: ",-1)),h.withDirectives(h.createElementVNode("input",{type:"date","onUpdate:modelValue":m[7]||(m[7]=w=>b.value.end=w),class:"mt-1 p-1 border rounded-md w-full text-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[h.vModelText,b.value.end]])]),h.createElementVNode("div",Ul,[h.createElementVNode("span",Fl," Computed duration: "+h.toDisplayString(fe.value)+" d. ",1)]),h.createElementVNode("button",{onClick:vn,class:"bg-blue-600 hover:bg-blue-700 text-gray-500 text-xs font-bold py-1 px-3 rounded-md transition duration-150"}," Validate "),h.createElementVNode("button",{onClick:m[8]||(m[8]=w=>b.value=null),class:"absolute top-1 right-1 text-gray-500 hover:text-gray-800 text-xs"},"  ")],4)):h.createCommentVNode("",!0)]))}},[["__scopeId","data-v-a0ba9fd3"]]);return{install(t){t.component("GanttChart",Il)}}});
